@using BizsolTech.Chatbot.Models;
@model BusinessModel

@{
    ViewBag.Title = "Business";
    Layout = "_Layout";

    var isEdit = TempData["businessEditMode"] != null ? (bool)TempData.Peek("businessEditMode") : false;
}

<widget target-zone="teaser">
    <partial name="ChatStep" model="new ChatStepModel { ChatProgressStep = ChatProgressStep.Initial }" />
</widget>
<partial name="_ChatInput" model="@Model" />

@if (isEdit)
{
    <div><h2>Uploaded documents</h2></div>
    <div class="table-responsive">
        <table id="documentsGrid" class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Extension</th>
                    <th>Size</th>
                    <th>&nbsp;</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var doc in Model.Documents)
                {
                    <tr>
                        <td>
                            @doc.Name
                        </td>
                        <td>@doc.Extension</td>
                        <td>@doc.Size</td>
                        <td>
                            <div>
                                <span class="delete-icon" onclick="deleteDocument('@Url.Action("DeleteDocument", "Business", new { documentId = doc.Id})')">
                                    <i class="fas fa-trash-alt"></i>
                                </span>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

<script sm-target-zone="scripts" data-origin="BusinessIndex">
    function deleteDocument(url) {
        if (confirm("Are you sure you want to delete this document?")) {
            $.ajax({
                url: url,
                type: 'GET',
                success: function () {
                },
                error: function () {
                    alert('Error deleting document.');
                }
            });
        }
    }
</script>